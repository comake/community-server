{
  "@context": "https://linkedsoftwaredependencies.org/bundles/npm/@solid/community-server/^3.0.0/components/context.jsonld",
  "import": [
    "files-scs:config/app/init/initializers/root.json"
  ],
  "@graph": [
    {
      "comment": "Handles everything related to the first-time server setup.",
      "@id": "urn:solid-server:default:SetupHttpHandler",
      "@type": "ParsingHttpHandler",
      "ParsingHttpHandler:_args_requestParser": { "@id": "urn:solid-server:default:RequestParser" },
      "ParsingHttpHandler:_args_metadataCollector": { "@id": "urn:solid-server:default:OperationMetadataCollector" },
      "ParsingHttpHandler:_args_errorHandler": { "@id": "urn:solid-server:default:ErrorHandler" },
      "ParsingHttpHandler:_args_responseWriter": { "@id": "urn:solid-server:default:ResponseWriter" },
      "ParsingHttpHandler:_args_operationHandler": {
        "@type": "SetupHttpHandler",
        "SetupHttpHandler:_args_handler": {
          "@type": "SetupHandler",
          "SetupHandler:_args_initializer": { "@id": "urn:solid-server:default:RootInitializer" },
          "SetupHandler:_args_registrationManager": { "@id": "urn:solid-server:default:SetupRegistrationManager" }
        },
        "SetupHttpHandler:_args_converter": { "@id": "urn:solid-server:default:RepresentationConverter" },
        "SetupHttpHandler:_args_storageKey": "setupCompleted-2.0",
        "SetupHttpHandler:_args_storage": { "@id": "urn:solid-server:default:SetupStorage" },
        "SetupHttpHandler:_args_templateEngine": {
          "comment": "Renders the specific page and embeds it into the main HTML body.",
          "@type": "ChainedTemplateEngine",
          "ChainedTemplateEngine:_renderedName": "htmlBody",
          "ChainedTemplateEngine:_engines": [
            {
              "comment": "Renders the main setup template.",
              "@type": "EjsTemplateEngine",
              "EjsTemplateEngine:_template": {
                "@type": "@json",
                "@value": {
                  "templateFile": "@css:templates/setup/index.html.ejs"
                }
              }
            },
            {
              "comment": "Will embed the result of the first engine into the main HTML template.",
              "@type": "EjsTemplateEngine",
              "EjsTemplateEngine:_template": {
                "@type": "@json",
                "@value": {
                  "templateFile": "@css:templates/main.html.ejs"
                }
              }
            }
          ]
        }
      }
    },
    {
      "comment": "Separate manager from the RegistrationHandler in case registration is disabled.",
      "@id": "urn:solid-server:default:SetupRegistrationManager",
      "@type": "RegistrationManager",
      "RegistrationManager:_args_baseUrl": { "@id": "urn:solid-server:default:variable:baseUrl" },
      "RegistrationManager:_args_webIdSuffix": "/profile/card#me",
      "RegistrationManager:_args_identifierGenerator": { "@id": "urn:solid-server:default:IdentifierGenerator" },
      "RegistrationManager:_args_ownershipValidator": { "@id": "urn:solid-server:auth:password:OwnershipValidator" },
      "RegistrationManager:_args_accountStore": { "@id": "urn:solid-server:auth:password:AccountStore" },
      "RegistrationManager:_args_podManager": { "@id": "urn:solid-server:default:PodManager" }
    }
  ]
}
